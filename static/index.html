<html>
<head>
  <title>Simple StatsD Counters</title>
  <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
  <script type="text/javascript" src="jquery.dynatable.js"></script>
  <link rel="stylesheet" type="text/css" href="bootstrap.min.css">
</head>

<body>
  <h1>Statsd Viewer</h1>
  <h2>Counters</h2>
  <table class="table table-striped" id="counters">
    <thead>
      <th>Counter Name</th>
      <th>Value</th>
    </thead>
    <tbody>
    </tbody>
  </table>
  <script type="text/javascript">
    var countersTable = $('#counters').dynatable({
      features: {
        paginate: false,
        sort: true,
        search: true,
        recordCount: true,
        pushState: true
      },
      dataset: {
        records: []
      },
      inputs: {
        queryEvent: 'keyup'
      },
      params: {
        dynatable: 'counters'
      }
    }).data('dynatable');

    function reload() {
      console.log('reload');
      $.ajax({
        url: '/counters',
        success: function(data){
          // t.records.updateFromJson({
          //   records: data
          // });
          countersTable.settings.dataset.originalRecords = data;
          countersTable.process();
        }
      });
    }

    reload()
    setInterval(reload, 1000);
  </script>
</body>
</html>
